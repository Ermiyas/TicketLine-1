<div class="col-12 row">
  <div class="col-7">

    <!-- form to add seats to floorplan. Only shown when 'New SeatPlan' is sellected -->
    <form [hidden]="getSelectedHall() !== newSeatPlan" [formGroup]="addSeatsForm" (ngSubmit)="addSeats()">
      <div class="row col-12 mt-3">
        <div class="row text-nowrap col-8 p-0">
          <div class="input-group">
            <div class="input-group-prepend col-5 p-0">
              <span class="input-group-text col-12">Seat Rows</span>
            </div>
            <label class="sr-only" for="seatRowStart">Seat Row Start</label>
            <input id="seatRowStart" type="number" formControlName="seatRowStart" class="form-control"
                   aria-labelledby="seat row start"/>
            <span class="input-group-text">-</span>
            <label class="sr-only" for="seatRowEnd">Seat Row End</label>
            <input id="seatRowEnd" type="number" formControlName="seatRowEnd" class="form-control"
                   aria-labelledby="seat row end"/>
          </div>
        </div>
        <div class="col-4 px-4">
          <label for="seatPrice" class="sr-only">Seat Price</label>
          <select id="seatPrice" formControlName="seatPrice" class="form-control col-12">
            <option *ngFor="let price of priceCategories">{{price}}</option>
          </select>
        </div>
      </div>
      <div *ngIf="seatRowErrors()" class="row col-12">
        <small class="form-text text-warning text-left">
          A valid seat row number greater than or equal to 1 must be entered!
        </small>
      </div>
      <div *ngIf="addSeatsForm.get('seatPrice').errors" class="row col-12">
        <small class="form-text text-warning text-left">
          A price category must be chosen!
        </small>
      </div>
      <div class="row col-12 mt-3">
        <div class="row text-nowrap col-8 p-0">
          <div class="input-group">
            <div class="input-group-prepend col-5 p-0">
              <span class="input-group-text col-12">Seat Number</span>
            </div>
            <label class="sr-only" for="seatNumberStart">Seat Number Start</label>
            <input id="seatNumberStart" type="number" formControlName="seatNumberStart" class="form-control"
                   aria-labelledby="seat number start"/>
            <span class="input-group-text">-</span>
            <label class="sr-only" for="seatNumberEnd">Seat Number End</label>
            <input id="seatNumberEnd" type="number" formControlName="seatNumberEnd" class="form-control"
                   aria-labelledby="seat number end"/>
          </div>
        </div>
      </div>
      <div *ngIf="seatNumberErrors()" class="row col-12">
        <small class="form-text text-warning text-left">
          A valid seat number greater than or equal to 1 must be entered!
        </small>
      </div>
      <div class="row col-12 mt-3">
        <div class="row text-nowrap col-12 p-0">
          <button type="submit" class="btn btn-success col-3 mr-2" [disabled]="addSeatsForm.invalid">Add Seats</button>
          <button type="button" class="btn btn-danger col-3" (click)="deleteSeats()" [disabled]="addSeatsForm.invalid">
            Delete Seats
          </button>
        </div>
      </div>
    </form>

    <!-- form to add sectors to floorplan, only shown when 'new SectorPlan' is selected  -->
    <form [hidden]="getSelectedHall() !== newSectorPlan" [formGroup]="addSectorsForm"
          (ngSubmit)="addSectors()">
      <div class="row col-12 mt-3">
        <div class="row text-nowrap col-8 p-0">
          <div class="input-group">
            <div class="input-group-prepend col-5 p-0">
              <span class="input-group-text col-12">Sector Number</span>
            </div>
            <label class="sr-only" for="sectorNumberStart">Sector Number Start</label>
            <input id="sectorNumberStart" type="number" formControlName="sectorNumberStart" class="form-control"
                   aria-labelledby="sector number start"/>
            <span class="input-group-text">-</span>
            <label class="sr-only" for="sectorNumberEnd">Sector Number End</label>
            <input id="sectorNumberEnd" type="number" formControlName="sectorNumberEnd" class="form-control"
                   aria-labelledby="sector number end"/>
          </div>
        </div>
        <div class="col-4 px-4 mr-0">
          <label for="sectorPrice" class="sr-only">Sector Price</label>
          <select id="sectorPrice" formControlName="sectorPrice" class="form-control col-12">
            <option *ngFor="let price of priceCategories">{{price}}</option>
          </select>
        </div>
      </div>
      <div *ngIf="sectorNumberErrors()" class="row col-12">
        <small class="form-text text-warning text-left">
          A valid sector number greater than or equal to 1 must be entered!
        </small>
      </div>
      <div *ngIf="addSectorsForm.get('sectorPrice').errors" class="row col-12">
        <small class="form-text text-warning text-left">
          A valid price category must be chosen!
        </small>
      </div>
      <div class="row col-12 mt-3">
        <div class="row text-nowrap col-12 p-0">
          <button type="submit" class="btn btn-success col-3 mr-2" [disabled]="addSectorsForm.invalid">Add Sectors</button>
          <button type="button" class="btn btn-danger col-3" (click)="deleteSectors()" [disabled]="addSectorsForm.invalid">Delete Sectors</button>
        </div>
      </div>
    </form>
  </div>
  <!-- selection hall by hall name and location / add new halls form -->
  <form [formGroup]="createHallForm" class="col-5">
    <div class="form-inline col-12 mt-3">
      <label for="locationSelection" class="col-3 input-group-text justify-content-start">Location</label>
      <select id="locationSelection" class="form-control col-9"
              formControlName="locationSelection"
              aria-labelledby="Location selection">
        <option [ngValue]="null"></option>
        <option *ngFor="let location of locations"
                [ngValue]="location">{{displayLocation(location)}}</option>
      </select>
    </div>
    <div [hidden]="createHallForm.controls.locationSelection.valid || createHallForm.pristine"
         class="form-inline col-12">
      <small class="form-text text-danger">
        Please select a location for your newly created hall!
      </small>
    </div>
    <div class="form-inline col-12 mt-3">
      <label for="hallSelection" class="col-3 input-group-text justify-content-start">Hall</label>
      <select id="hallSelection" class="form-control col-9"
              formControlName="hallSelection"
              aria-labelledby="Hall">
        <option [ngValue]="newSeatPlan">{{newSeatPlan.name}}</option>
        <option [ngValue]="newSectorPlan">{{newSectorPlan.name}}</option>
        <option *ngFor="let hall of halls" [ngValue]="hall">{{hall.name}}</option>
      </select>
    </div>
    <div class="form-inline col-12 mt-3">
      <button *ngIf="getSelectedHall() === newSeatPlan" type="button" class="btn btn-success"
              data-toggle="modal" data-target="#enterName" [disabled]="getSelectedHall().seats.length < 1">
        Add Seat Plan
      </button>
      <button *ngIf="getSelectedHall() === newSectorPlan" type="button" class="btn btn-success"
              data-toggle="modal" data-target="#enterName" [disabled]="getSelectedHall().sectors.length < 1">
        Add Sector Plan
      </button>
    </div>
  </form>
</div>
<hr/>
<!-- Bootstrap modal to post new floor plan -->
<div class="modal fade" id="enterName" tabindex="-1" role="dialog" aria-labelledby="Enter name for new floor plan"
     aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Please enter a name!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">x</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="createHallForm" (ngSubmit)="createFloorplan()">
          <div class="form-group" [hidden]="createHallForm.get('locationSelection').valid">
            <label for="locationSelectionModal">Location</label>
            <select id="locationSelectionModal" class="form-control"
                    formControlName="locationSelection"
                    aria-labelledby="Location selection">
              <option [ngValue]="null"></option>
              <option *ngFor="let location of locations"
                      [ngValue]="location">{{displayLocation(location)}}</option>
            </select>
          </div>
          <div [hidden]="createHallForm.get('locationSelection').valid || createHallForm.get('locationSelection').pristine"
               class="form-inline col-12 mb-2">
            <small class="form-text text-danger">
              Please select a hall location!
            </small>
          </div>
          <div class="form-group">
            <label for="floorplanName">Name</label>
            <input id="floorplanName" class="form-control" type="text" [formGroup]="createHallForm"
                   formControlName="floorplanName" aria-labelledby="hall name"/>
          </div>
          <div [hidden]="createHallForm.get('floorplanName').valid || createHallForm.get('floorplanName').pristine"
               class="form-inline col-12 mb-2">
            <small class="form-text text-danger">
              Please enter a name!
            </small>
          </div>
          <div>
            <button type="submit" class="btn btn-success float-right" [disabled]="createHallForm.invalid"
                    (click)="createFloorplan()" data-dismiss="modal">Create Floor Plan
            </button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- form to allow updating or deleting single seats -->
<div id="updateSeatForm" class="updateForm">
  <form [formGroup]="updateSeatForm">
    <div class="form-row-custom">
      <div class="form-inline-custom">
        <label for="seatNumber">Number</label>
        <input id="seatNumber" type="number" formControlName="seatNumber" aria-labelledby="seat number"/>
      </div>
      <div class="form-inline-custom">
        <label for="priceCategorySeat" class="sr-only">Price Category</label>
        <select id="priceCategorySeat" formControlName="seatPrice" aria-labelledby="price category">
          <option *ngFor="let price of priceCategories">{{price}}</option>
        </select>
      </div>
    </div>
    <div class="error-row-custom" [hidden]="updateSeatForm.get('seatNumber').valid || updateSeatForm.pristine">
      <small class="form-text text-danger text-left">
        A valid seat number between 1 and 100 is required!
      </small>
    </div>
    <div class="error-row-custom" [hidden]="updateSeatForm.get('seatPrice').valid || updateSeatForm.pristine">
      <small class="form-text text-danger">
        A price category must be chosen
      </small>
    </div>
    <div class="form-row-custom">
      <div class="form-inline-custom">
        <label for="seatRow">Row</label>
        <input id="seatRow" type="number" formControlName="seatRow" aria-labelledby="seat row"/>
      </div>
      <div class="form-inline-custom">
        <button type="button" class="btn btn-success" (click)="updateSeat()">Update Seat</button>
      </div>
    </div>
    <div class="form-row-custom">
      <div class="form-inline-custom">

      </div>
      <div class="form-inline-custom">
        <button type="button" class="btn btn-danger" (click)="deleteSeat()">Delete Seat</button>
      </div>
    </div>
    <div class="error-row-custom" [hidden]="updateSeatForm.get('seatRow').valid || updateSeatForm.pristine">
      <small class="form-text text-danger text-left">
        A valid seat row between 1 and 100 must be chosen!
      </small>
    </div>
    <div class="error-row-custom" [hidden]="seatAlreadyExists === false">
      <small class="form-text text-danger text-left">
        A seat with this number already exists in this row!
      </small>
    </div>
  </form>
</div>
<!-- form to allow updating or deleting single sectors -->
<div id="updateSectorForm" class="updateForm">
  <form [formGroup]="updateSectorForm">
    <div class="form-row-custom">
      <div class="form-inline-custom">
        <label for="sectorNumber">Number</label>
        <input id="sectorNumber" type="number" formControlName="sectorNumber" aria-labelledby="sector number"/>
      </div>
      <div class="form-inline-custom">
        <label for="priceCategorySector" class="sr-only">Price Category</label>
        <select id="priceCategorySector" formControlName="sectorPrice" aria-labelledby="price category">
          <option *ngFor="let price of priceCategories">{{price}}</option>
        </select>
      </div>
    </div>
    <div class="error-row-custom" [hidden]="updateSectorForm.get('sectorNumber').valid || updateSectorForm.pristine">
      <small class="form-text text-danger text-left">
        A valid sector number must be entered!
      </small>
    </div>
    <div class="error-row-custom" [hidden]="updateSectorForm.get('sectorPrice').valid || updateSectorForm.pristine">
      <small class="form-text text-danger">
        A price category must be chosen!
      </small>
    </div>
    <div class="form-row-custom">
      <div class="form-inline-custom"></div>
      <div class="form-inline-custom">
        <button type="submit" class="btn btn-success" (click)="updateSector()">Update Sector</button>
      </div>
    </div>
    <div class="form-row-custom">
      <div class="form-inline-custom"></div>
      <div class="form-inline-custom">
        <button type="submit" class="btn btn-danger" (click)="deleteSector()">Delete Sector</button>
      </div>
    </div>
    <div class="error-row-custom" [hidden]="sectorAlreadyExists === false">
      <small class="form-text text-danger text-left">
        A sector with this number already exists!
      </small>
    </div>
  </form>
</div>
<!-- draw floor plan -->
<app-floorplan *ngIf="getSelectedHall().seats !== null && getSelectedHall().seats.length > 0"
               [seats]="getSelectedHall().seats"
               (selectedSeat)="displaySeatForm($event)"
               (click)="onSvgClick($event)"></app-floorplan>
<app-floorplan *ngIf="getSelectedHall().sectors !== null && getSelectedHall().sectors.length > 0"
               [sectors]="getSelectedHall().sectors"
               (selectedSector)="displaySectorForm($event)"
               (click)="onSvgClick($event)"></app-floorplan>
